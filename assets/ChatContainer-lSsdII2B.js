const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownComp-BjqU-srD.js","assets/index-BXJA53Pn.js","assets/index-CEdlOD4T.css","assets/MarkdownComp-B5eUVdjS.css"])))=>i.map(i=>d[i]);
import{j as e,n as E,r as o,_ as se,u as te,a as oe,A as C,b as M,m as le}from"./index-BXJA53Pn.js";import{u as ne}from"./useSidebar-BXGiJA6s.js";import{u as ie,a as re}from"./useToggle-C9Zy_hAv.js";const B="/sales/assets/botLogo-BJwa39RH.svg",ae=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.4rem",height:"1.4rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"#000",d:"M5 2h14a1 1 0 0 1 1 1v19.143a.5.5 0 0 1-.766.424L12 18.03l-7.234 4.536A.5.5 0 0 1 4 22.143V3a1 1 0 0 1 1-1m13 2H6v15.432l6-3.761l6 3.761z"})}),ce=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.4rem",height:"1.4rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"#fd0000",d:"M5 2h14a1 1 0 0 1 1 1v19.143a.5.5 0 0 1-.766.424L12 18.03l-7.234 4.536A.5.5 0 0 1 4 22.143V3a1 1 0 0 1 1-1"})});function R({color:a,size:i}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"m7 7l10 10M7 17L17 7"})})}function de(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 16 16",children:e.jsxs("g",{fill:"black",children:[e.jsx("path",{d:"m8 9.076l.085-.107a.751.751 0 1 0-1.171-.937L5.438 9.877L5.03 9.47a.747.747 0 0 0-1.06 0a.75.75 0 0 0 0 1.06l.407.408l.593.592a.75.75 0 0 0 1.116-.061l.522-.654h.001z"}),e.jsx("path",{fillRule:"evenodd",d:"M12 11a3 3 0 0 0 3-3V4a3 3 0 0 0-3-3H8a3 3 0 0 0-3 3v1H4a3 3 0 0 0-3 3v4a3 3 0 0 0 3 3h4a3 3 0 0 0 3-3v-1zM4 6.5A1.5 1.5 0 0 0 2.5 8v4A1.5 1.5 0 0 0 4 13.5h4A1.5 1.5 0 0 0 9.5 12V8A1.5 1.5 0 0 0 8 6.5zM13.5 4A1.5 1.5 0 0 0 12 2.5H8A1.5 1.5 0 0 0 6.5 4v1H8a3 3 0 0 1 3 3v1.5h1A1.5 1.5 0 0 0 13.5 8z",clipRule:"evenodd"})]})})}function me(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"black",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V6.2c0-1.12 0-1.68.218-2.108c.192-.377.497-.682.874-.874C10.52 3 11.08 3 12.2 3h5.6c1.12 0 1.68 0 2.108.218a2 2 0 0 1 .874.874C21 4.52 21 5.08 21 6.2v5.6c0 1.12 0 1.68-.218 2.108a2.002 2.002 0 0 1-.874.874C19.48 15 18.92 15 17.803 15H15M9 9H6.2c-1.12 0-1.68 0-2.108.218a1.999 1.999 0 0 0-.874.874C3 10.52 3 11.08 3 12.2v5.6c0 1.12 0 1.68.218 2.108a2 2 0 0 0 .874.874c.427.218.987.218 2.105.218h5.607c1.117 0 1.676 0 2.104-.218a2 2 0 0 0 .874-.874c.218-.428.218-.987.218-2.105V15M9 9h2.8c1.12 0 1.68 0 2.108.218a2 2 0 0 1 .874.874c.218.427.218.987.218 2.105V15"})})}function he(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"black",d:"M20 3H6.693A2.01 2.01 0 0 0 4.82 4.298l-2.757 7.351A1 1 0 0 0 2 12v2c0 1.103.897 2 2 2h5.612L8.49 19.367a2.004 2.004 0 0 0 .274 1.802c.376.52.982.831 1.624.831H12c.297 0 .578-.132.769-.36l4.7-5.64H20c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2m-8.469 17h-1.145l1.562-4.684A1 1 0 0 0 11 14H4v-1.819L6.693 5H16v9.638zM18 14V5h2l.001 9z"})})}function xe(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"#c74242",d:"M20 3h-1v13h1a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2M4 16h7l-1.122 3.368A2 2 0 0 0 11.775 22H12l5-5.438V3H6l-3.937 8.649l-.063.293V14a2 2 0 0 0 2 2"})})}function ue(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"black",d:"M20 8h-5.612l1.123-3.367c.202-.608.1-1.282-.275-1.802S14.253 2 13.612 2H12c-.297 0-.578.132-.769.36L6.531 8H4c-1.103 0-2 .897-2 2v9c0 1.103.897 2 2 2h13.307a2.01 2.01 0 0 0 1.873-1.298l2.757-7.351A1 1 0 0 0 22 12v-2c0-1.103-.897-2-2-2M4 10h2v9H4zm16 1.819L17.307 19H8V9.362L12.468 4h1.146l-1.562 4.683A.998.998 0 0 0 13 10h7z"})})}function pe(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"#42c758",d:"M4 21h1V8H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2M20 8h-7l1.122-3.368A2 2 0 0 0 12.225 2H12L7 7.438V21h11l3.912-8.596L22 12v-2a2 2 0 0 0-2-2"})})}function ge(){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"3rem",height:"1rem",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:0,cy:12,r:3,fill:"black",children:e.jsx("animate",{id:"svgSpinners3DotsBounce0",attributeName:"cy",begin:"0;svgSpinners3DotsBounce1.end+0.25s",calcMode:"spline",dur:"0.6s",keySplines:".33,.66,.66,1;.33,0,.66,.33",values:"12;6;12"})}),e.jsx("circle",{cx:15,cy:12,r:3,fill:"black",children:e.jsx("animate",{attributeName:"cy",begin:"svgSpinners3DotsBounce0.begin+0.1s",calcMode:"spline",dur:"0.6s",keySplines:".33,.66,.66,1;.33,0,.66,.33",values:"12;6;12"})}),e.jsx("circle",{cx:30,cy:12,r:3,fill:"black",children:e.jsx("animate",{id:"svgSpinners3DotsBounce1",attributeName:"cy",begin:"svgSpinners3DotsBounce0.begin+0.2s",calcMode:"spline",dur:"0.6s",keySplines:".33,.66,.66,1;.33,0,.66,.33",values:"12;6;12"})})]})}function ve(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5rem",height:"1.5rem",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"white",d:"M12 2a5 5 0 1 1-5 5l.005-.217A5 5 0 0 1 12 2m2 12a5 5 0 0 1 5 5v1a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-1a5 5 0 0 1 5-5z"})})}const we=({handleCloseModal:a,setModalFeedbackMsg:i,modalFeedbackMsg:c,handleNegativeModalForm:r,feedbackAdditional:h,setFeedbackAdditional:d})=>e.jsx("div",{className:"fixed z-50 top-0 right-0 w-full h-full bg-black bg-opacity-50 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white border rounded-lg p-4 w-[550px] relative",children:[e.jsx("button",{className:"absolute right-2 top-2",onClick:a,children:e.jsx(R,{color:"#000000",size:"1.5rem"})}),e.jsx("p",{className:"text-xl font-semibold border-b pb-2",children:"Provide additional feedback:"}),e.jsx("div",{className:"my-6 flex flex-wrap gap-2",children:E.map(n=>e.jsx("button",{onClick:()=>i(n),className:`border px-2 py-1 rounded-md ${c===n&&"bg-primaryBG border-primary"}`,children:e.jsx("p",{children:n})},n))}),e.jsxs("form",{onSubmit:r,className:"flex flex-col my-4 gap-4",children:[e.jsx("input",{type:"text",value:h,onChange:n=>d(n.target.value),className:"border px-2 py-1 rounded",placeholder:"(optional) Feel free to add specific details"}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:`float-right bg-gray-400 w-24 h-8 text-white rounded-lg hover:bg-gray-500 ${c.length&&"bg-green-500 hover:bg-green-600"}`,children:"Submit"})})]})]})}),z=o.lazy(()=>se(()=>import("./MarkdownComp-BjqU-srD.js"),__vite__mapDeps([0,1,2,3]))),ke=({chats:a,loading:i,message:c})=>{const r=o.useRef(null),h=o.useRef({}),{session:d}=te(),{hideSidebar:n}=ne(),{updateChat:T}=oe(),{bookmarks:D,bookmarkID:g,clearBookmarkId:S}=ie(),{toggleBookmark:H}=re(),[L,P]=o.useState(!0),[$,A]=o.useState(null),[v,w]=o.useState(!1),[q,f]=o.useState(!1),[m,x]=o.useState(""),[_,b]=o.useState(""),[j,u]=o.useState(""),[p,k]=o.useState(null),y=o.useCallback(()=>{if(!r.current)return;const{scrollTop:s,scrollHeight:t,clientHeight:l,offsetTop:N}=r.current,ee=t-s<=l+N;P(ee)},[]);o.useEffect(()=>{const s=r.current;L&&s&&s.scrollTo({top:s.scrollHeight,behavior:"auto"})},[i,c,L,a,v]),o.useEffect(()=>{const s=r.current;return s&&s.addEventListener("scroll",y),()=>{s&&s.removeEventListener("scroll",y)}},[y]);const O=s=>{k(s),w(!0)},G=()=>{k(null),w(!1),x(""),u("")},U=s=>{V(s,"positive")},I=()=>{p&&V(p,"negative"),w(!1),k(null),f(!1)},W=s=>{s.preventDefault(),!(m===""&&j==="")&&I()},V=async(s,t)=>{try{const l=`${C}/store/`,N={input_prompt:s.message,output:s.answer,ques_id:s.id,input_prompt_timestamp:s.inputTimestamp,output_timestamp:s.outputTimestamp,session:d,feedback:t,select_feedback_response:v?_:m,additional_comments:j};await M.post(l,N),T({...s,feedback:t}),F()}catch(l){console.log(l)}},J=async s=>{A(s);const t=le(s);K(t),setTimeout(()=>A(null),1e3)},K=async s=>{await navigator.clipboard.writeText(s)},Q=()=>{f(!0),b(""),x(""),u("")},F=()=>{f(!1),b(""),x(""),u("")},X=async s=>{try{const t=`${C}/bookmark/`,l={session_id:d,ques_id:s};await M.post(t,l),H()}catch(t){console.log(t)}},Y=async s=>{try{const t=`${C}/bookmark/`,l={data:{ques_id:s,session_id:d}};await M.delete(t,l),H()}catch(t){console.log(t)}};o.useEffect(()=>{if(g){const s=h.current[g];s&&s.scrollIntoView({behavior:"instant",block:"start"}),S()}},[g,S]);const Z=o.useCallback((s,t)=>{h.current[t.id]=s},[]);return e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Page is Loading..."}),children:e.jsxs("div",{onClick:n,ref:r,className:"flex-1 lg:w-[800px] lg:mx-auto overflow-y-auto px-2 min-h-[400px] relative",children:[a.map(s=>e.jsxs("div",{className:"",ref:t=>Z(t,s),children:[s.message!==""&&e.jsxs("div",{className:"flex gap-2 items-start justify-end my-1",children:[e.jsx("div",{className:"max-w-[85%] bg-borderGrey px-4 py-2 rounded-xl whitespace-pre-line",children:e.jsx("p",{children:s.message})}),e.jsx("div",{children:e.jsx("div",{className:"bg-primary rounded-full w-8 h-8 flex justify-center items-center mt-1",children:e.jsx(ve,{})})})]}),s.answer!==""&&e.jsxs("div",{className:"flex gap-2 items-start my-1",children:[e.jsx("img",{src:B,alt:"bot logo",className:"mt-1 rounded-full w-8 h-8"}),e.jsxs("div",{className:"max-w-[85%] px-2 py-2 overflow-y-auto",children:[e.jsx(z,{markdownContent:s.answer}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("button",{onClick:()=>U(s),children:(s==null?void 0:s.feedback)==="positive"?e.jsx(pe,{}):e.jsx(ue,{})}),e.jsx("button",{onClick:()=>O(s),children:(s==null?void 0:s.feedback)==="negative"?e.jsx(xe,{}):e.jsx(he,{})}),e.jsx("button",{onClick:()=>J(s.message),children:$===s.message?e.jsx(de,{}):e.jsx(me,{})}),D.find(t=>t.ques_id===s.id)?e.jsx("button",{onClick:()=>Y(s.id),children:e.jsx(ce,{})}):e.jsx("button",{onClick:()=>X(s.id),children:e.jsx(ae,{})})]})]})]}),v&&p!==null&&s.id===p.id&&e.jsxs("div",{className:"border relative rounded-lg px-4 py-2 w-96 ml-8 bg-white",children:[e.jsx("button",{className:"absolute right-2 top-2",onClick:G,children:e.jsx(R,{color:"#000000",size:"1.5rem"})}),e.jsx("p",{children:"Tell us more:"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[E.map(t=>e.jsx("button",{onClick:()=>x(t),className:`border px-2 py-1 rounded-md ${m===t&&"bg-primaryBG border-primary"}`,children:e.jsx("p",{children:t})},t)),e.jsx("button",{onClick:Q,className:"border px-2 py-1 rounded-md",children:e.jsx("p",{children:"More..."})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:` w-24 h-8 text-white rounded-lg disabled:bg-gray-400 disabled:hover:bg-gray-500 ${m.length&&"bg-green-500 hover:bg-green-600"}`,onClick:I,disabled:!m,children:"Send"})})]})]},s.id)),i&&e.jsxs("div",{className:"flex gap-2 items-start my-1",children:[e.jsx("img",{src:B,alt:"bot logo",className:"mt-1 rounded-full w-8 h-8"}),e.jsx("div",{className:"px-1 pb-1 mt-auto",children:e.jsx(ge,{})})]}),c&&e.jsxs("div",{className:"flex gap-2 items-start my-1",children:[e.jsx("img",{src:B,alt:"bot logo",className:"mt-1 rounded-full w-8 h-8"}),e.jsx("div",{className:"max-w-[85%] px-2 py-2 overflow-y-auto",children:e.jsx(z,{markdownContent:c})})]}),q&&e.jsx(we,{handleCloseModal:F,setModalFeedbackMsg:b,modalFeedbackMsg:_,handleNegativeModalForm:W,feedbackAdditional:j,setFeedbackAdditional:u})]})})};export{ke as default};
